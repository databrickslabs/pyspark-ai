{"key": "\nGiven a Spark temp view `temp_view_for_transform` with the following columns:\n```\nid: bigint\n```\nWrite a Spark SQL query to retrieve: add a column with the name x and the value 1\nThe answer MUST contain query only. Ensure your answer is correct.\n", "value": "SELECT id, 1 AS x\nFROM temp_view_for_transform"}
{"key": "\nGiven a Spark temp view `temp_view_for_transform` with the following columns:\n```\nid: bigint\nx: int\n```\nWrite a Spark SQL query to retrieve: add a column with the name y and the value 2\nThe answer MUST contain query only. Ensure your answer is correct.\n", "value": "```sql\nSELECT id, x, 2 AS y\nFROM temp_view_for_transform\n```"}
{"key": "\nGiven a PySpark dataframe with the following schema:\n\n```\nid: bigint\n```\n\nWrite a Python function called `transform_df` with the input parameter `df` of the type DataFrame that performs the\nfollowing transformation and returns a new dataframe: add a column with the name x and the value 1\n\nIn addition the generated code must follow adhere to the following requirements:\n\n  * The answer code MUST contain one function only.\n  * The answer must not contain code outside of the function definition (except imports).\n  * The generated code MUST NOT call the generated function.\n  * The generated code must not create or use a SparSession but only use the input `df` variable.\n  * Do not provide examples of the usage of the function.\n  * Do not provide more than one code block.\n\nEnsure your answer is correct.\n", "value": "```python\ndef transform_df(df):\n    from pyspark.sql.functions import lit\n\n    return df.withColumn('x', lit(1))\n```"}
{"key": "\nGiven a PySpark dataframe with the following schema:\n\n```\nid: bigint\nx: int\n```\n\nWrite a Python function called `transform_df` with the input parameter `df` of the type DataFrame that performs the\nfollowing transformation and returns a new dataframe: add a column with the name y and the value 2\n\nIn addition the generated code must follow adhere to the following requirements:\n\n  * The answer code MUST contain one function only.\n  * The answer must not contain code outside of the function definition (except imports).\n  * The generated code MUST NOT call the generated function.\n  * The generated code must not create or use a SparSession but only use the input `df` variable.\n  * Do not provide examples of the usage of the function.\n  * Do not provide more than one code block.\n\nEnsure your answer is correct.\n", "value": "```python\nfrom pyspark.sql.functions import lit\n\ndef transform_df(df):\n    return df.withColumn(\"y\", lit(2))\n```"}
